var version=function(e,t,l,a,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(t),i=r(l);const c="pseudoConfigIcon",d="refetchDataIcon",u={DATA_LAST_FETCHED:{en:"Data last fetched",nb:"Data sist hentet"},FILTER_TABLE:{en:"Filter table",nb:"Filtrere tabellen"},HEADER:{en:"Catalog Viewer",nb:"Katalogvisning"},PATH:{en:"Path",nb:"Sti"},PSEUDO_CONFIG:{en:"Pseudo config",nb:"Pseudo config"},REFRESH_TABLE:{en:"Fetch data again",nb:"Hent data pÃ¥ nytt"},STATE:{en:"State",nb:"Tilstand"},TIMESTAMP:{en:"Timestamp",nb:"Dato"},TYPE:{en:"Type",nb:"Type"},VALUATION:{en:"Valuation",nb:"Verdivurdering"}};function E({error:e,loading:t,filterBy:l,language:r,setFilterBy:i,refetch:c,fetchTime:E}){return o.default.createElement(a.Grid,{columns:"equal"},o.default.createElement(a.Grid.Column,null,o.default.createElement(a.Input,{fluid:!0,size:"large",icon:"search",value:l,disabled:t||!!e,placeholder:u.FILTER_TABLE[r],onChange:(e,{value:t})=>i(t)})),o.default.createElement(a.Grid.Column,null),o.default.createElement(a.Grid.Column,null),o.default.createElement(a.Grid.Column,{textAlign:"right",verticalAlign:"middle"},o.default.createElement(n.InfoPopup,{position:"left center",text:u.REFRESH_TABLE[r],trigger:o.default.createElement(a.Icon,{link:!0,name:"sync",size:"large",onClick:c,loading:t,disabled:t,style:{color:n.SSB_COLORS.BLUE},"data-testid":d})}),`${u.DATA_LAST_FETCHED[r]}: ${t?"-":E}`))}function s({commonPrefixes:e,length:t,setFilterBy:l}){return o.default.createElement(o.default.Fragment,null,e.map(e=>o.default.createElement(a.Label,{as:"a",size:"large",key:e[0],onClick:()=>l(`/${e[0]}/`),style:{backgroundColor:n.SSB_COLORS.BLUE,marginRight:"1rem"}},"/"+e[0],o.default.createElement(a.Label.Detail,null,`(${e[1]})`))),o.default.createElement(a.Label,{as:"a",size:"large",onClick:()=>l(""),style:{backgroundColor:n.SSB_COLORS.BLUE}},"/",o.default.createElement(a.Label.Detail,null,`(${t})`)))}function T({catalog:e,pseudoConfig:l,language:r}){const[i,d]=t.useState(!1);return"object"==typeof l&&null!==l&&0!==Object.keys(l).length?o.default.createElement(a.Modal,{closeIcon:!0,size:"large",open:i,style:n.SSB_STYLE,onClose:()=>d(!1),trigger:o.default.createElement(a.Icon,{link:!0,name:"key","data-testid":c,style:{color:n.SSB_COLORS.YELLOW},onClick:()=>d(!0)})},o.default.createElement(a.Header,{size:"large",style:n.SSB_STYLE},o.default.createElement(a.Icon,{name:"key",style:{color:n.SSB_COLORS.YELLOW}}),o.default.createElement(a.Header.Content,null,u.PSEUDO_CONFIG[r],o.default.createElement(a.Header.Subheader,null,e))),o.default.createElement(a.Modal.Content,{style:n.SSB_STYLE},o.default.createElement("pre",null,JSON.stringify(l,null,2)))):null}const C=(e,t,l)=>{switch(l){case"string":return e.sort((e,l)=>e.hasOwnProperty(t)&&l.hasOwnProperty(t)?e[t].localeCompare(l[t]):e.hasOwnProperty(t)?e[t].localeCompare(""):l.hasOwnProperty(t)?"".localeCompare(l[t]):0);case"timestamp":return e.sort((e,l)=>e.id.hasOwnProperty(t)&&l.id.hasOwnProperty(t)?new Date(l.id[t]-1e3)-new Date(e.id[t]-1e3):0);case"nestedString":return e.sort((e,l)=>e.id.hasOwnProperty(t)&&l.id.hasOwnProperty(t)?e.id[t].localeCompare(l.id[t]):0);default:return e}},O=(e,t=!1)=>{try{const l=new Date(e-1e3);let a={hour:"2-digit",minute:"2-digit"};return t&&(a.second="2-digit"),`${l.toLocaleDateString()} - ${l.toLocaleTimeString([],a)}`}catch(t){return console.log(t),e}},f={CATALOGS:"catalogs",CATALOG_OBJECT:{ENUM:["valuation","state","type"],OBJECT:{NAME:"id",STRING:["path","timestamp"]},STRING:["parentUri"]},GET_HEALTH:"/health/ready",GET_CATALOGS:"/catalog",GET_CATALOGS_BY_PREFIX:e=>`${f.GET_CATALOGS}/${e}`},g={OPEN:n.SSB_COLORS.BLUE,INTERNAL:n.SSB_COLORS.GREEN,SHIELDED:n.SSB_COLORS.YELLOW,SENSITIVE:n.SSB_COLORS.RED};function A({catalogs:e,handleSort:t,language:l,sortedBy:r,sortDirection:i}){return o.default.createElement(a.Table,{celled:!0,selectable:!0,sortable:!0,basic:"very",compact:"very",size:"large"},o.default.createElement(a.Table.Header,null,o.default.createElement(a.Table.Row,null,o.default.createElement(a.Table.HeaderCell,{onClick:()=>t(f.CATALOG_OBJECT.OBJECT.STRING[0],"nestedString"),sorted:r===f.CATALOG_OBJECT.OBJECT.STRING[0]?i:null},u.PATH[l]),o.default.createElement(a.Table.HeaderCell,{onClick:()=>t(f.CATALOG_OBJECT.OBJECT.STRING[1],"timestamp"),sorted:r===f.CATALOG_OBJECT.OBJECT.STRING[1]?i:null},u.TIMESTAMP[l]),o.default.createElement(a.Table.HeaderCell,{onClick:()=>t(f.CATALOG_OBJECT.ENUM[2],"string"),sorted:r===f.CATALOG_OBJECT.ENUM[2]?i:null},u.TYPE[l]),o.default.createElement(a.Table.HeaderCell,{onClick:()=>t(f.CATALOG_OBJECT.ENUM[0],"string"),sorted:r===f.CATALOG_OBJECT.ENUM[0]?i:null},u.VALUATION[l]),o.default.createElement(a.Table.HeaderCell,{onClick:()=>t(f.CATALOG_OBJECT.ENUM[1],"string"),sorted:r===f.CATALOG_OBJECT.ENUM[1]?i:null},u.STATE[l]),o.default.createElement(a.Table.HeaderCell,null,u.PSEUDO_CONFIG[l]))),o.default.createElement(a.Table.Body,null,e.map(({id:e,pseudoConfig:t,state:r,type:i,valuation:c},d)=>o.default.createElement(a.Table.Row,{key:d},o.default.createElement(a.Table.Cell,{style:{fontWeight:"bold"}},e[f.CATALOG_OBJECT.OBJECT.STRING[0]].length>100?o.default.createElement(a.Popup,{basic:!0,flowing:!0,trigger:o.default.createElement("div",null,n.truncateString(e[f.CATALOG_OBJECT.OBJECT.STRING[0]],100))},e[f.CATALOG_OBJECT.OBJECT.STRING[0]]):e[f.CATALOG_OBJECT.OBJECT.STRING[0]]),o.default.createElement(a.Table.Cell,null,O(e[f.CATALOG_OBJECT.OBJECT.STRING[1]])),o.default.createElement(a.Table.Cell,null,i),o.default.createElement(a.Table.Cell,{style:{color:g[c]}},c),o.default.createElement(a.Table.Cell,null,r),o.default.createElement(a.Table.Cell,{textAlign:"center"},o.default.createElement(T,{language:l,pseudoConfig:t,catalog:e[f.CATALOG_OBJECT.OBJECT.STRING[0]]}))))))}return e.CatalogView=function({restApi:e,language:l}){const[r,c]=t.useState(""),[d,u]=t.useState([]),[T,g]=t.useState(""),[S,m]=t.useState([]),[L,B]=t.useState("ascending"),[G,y]=t.useState(f.CATALOG_OBJECT.OBJECT.STRING[0]),[{data:_,loading:p,error:b},h]=i.default(`${e}${f.GET_CATALOGS}`);return t.useEffect(()=>{if(!p&&!b&&void 0!==_)if(Array.isArray(_[f.CATALOGS]))try{g(O(Date.now(),!0)),m((e=>{const t=e.map(e=>e.id.path.split("/").filter(e=>""!==e).slice(0,1)),l=[].concat.apply([],t).reduce((e,t)=>(t in e?e[t]++:e[t]=1,e),{});return Object.entries(l).sort((e,t)=>t[1]-e[1]).filter(e=>e[1]>=3)})(_[f.CATALOGS])),u(C(_[f.CATALOGS],f.CATALOG_OBJECT.OBJECT.STRING[0],"nestedString"))}catch(e){console.log(e)}else console.log("Recieved catalogs is not of Array format, recieved was:"),console.log(_)},[_,b,p]),t.useEffect(()=>{void 0!==_&&Array.isArray(_[f.CATALOGS])&&(e=>{try{y(""),B("ascending"),u(_[f.CATALOGS].filter(({id:t})=>t[f.CATALOG_OBJECT.OBJECT.STRING[0]].includes(e)))}catch(e){console.log(e)}})(r)},[_,r]),o.default.createElement(o.default.Fragment,null,o.default.createElement(E,{error:b,loading:p,refetch:h,filterBy:r,language:l,fetchTime:T,setFilterBy:c}),o.default.createElement(a.Divider,{hidden:!0}),p?o.default.createElement(a.Loader,{active:!0,inline:"centered"}):b?o.default.createElement(n.ErrorMessage,{error:b,language:l}):o.default.createElement(o.default.Fragment,null,o.default.createElement(s,{commonPrefixes:S,length:_[f.CATALOGS].length,setFilterBy:c}),o.default.createElement(a.Divider,{hidden:!0}),o.default.createElement(A,{language:l,sortedBy:G,catalogs:d,handleSort:(e,t)=>{e===G?(B("ascending"===L?"descending":"ascending"),u(d.reverse())):(y(e),u(C(d,e,t)))},sortDirection:L})))},e}({},React,axiosHooks,semanticUiReact,daplaJsUtilities);
